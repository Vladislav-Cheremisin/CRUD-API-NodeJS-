# CRUD-API-NodeJS-

## Установка приложения:

1. Установите LTS версию NodeJS с официального сайта.
2. Скачайте файлы приложения нажав на кнопку `Code` в правом верхнем углу репозитория и выбрав из контекстного меню удобный для вас способ загрузки.
3. Распакуйте файлы приложения на локальном диске своего устройства.
4. Откройте папку с файлами приложения используя редактор кода (например VSCode) или консоль.
5. Выполните в консоли команду `npm install`.

## Запуск приложения:

Приложение имеет следующие консольные команды позволяющие произвести запуск CRUD API:

- `npm run start:dev` - Запустить приложение в режиме разработки (без сборки с использованием Nodemon).
- `npm run start:prod` - Произвести сборку и последующий запуск приложения.
- `npm run start:multi` - Запустить приложение в многопоточном режиме с использованием кластера и балансировщика нагрузки.

## Тестирование приложения:

Приложение имеет 18 тестовых сценариев позволяющих проверить всю описанную ниже функциональность.
Исключением является лишь ошибка на стороне сервера. Чтобы проверить ее можно вставить `throw new Error('Error')` в любое место с логикой выполнения запросов в ./src/server.ts).

Для запуска модульных тестов необходимо выполнить в коносли следующую команду:

`npm run test`

**Используемые для тестирования библиотеки:**

- `jest`
- `ts-jest`
- `supertest`

## Функционал приложения:

Сервер поддерживает GET, POST, PUT и DELETE запросы.

**GET запросы**

GET запросы позволяют получать информацию о всех или конкретном пользователе из in-memory-database (массив содержащий в себе объекты с информацией о пользователях).

**GET запросы на `api/users`:**

- В случае успешного выполнения сервер ответит с статус кодом 200 и массивом содержащим в себе все записи пользователей (после запуска приложения массив пуст).

**GET запросы на `api/users/id`:**

- В случае успешного выполнения сервер ответит с статус кодом 200 и информацией о пользователе с введенным `id`.
- В случае если пользователь с введенным `id` не существует сервер ответит с статус кодом 404 и соответствующим сообщением.
- В случае если `id` введен не корректно (прим `api/users/JustTextNotId`) сервер ответит с статус кодом 400 и соответствующим сообщением.

**POST запросы на `api/users`:**

POST запрос позволяет добавить новых пользователей в массив пользователей.
Объект пользователя состоит из следующих свойств:

- `id` (генерируется сервером)
- `username` (строка)
- `age` (число)
- `hobbies` (массив строк)

В теле запроса обязательно должны быть `username`, `age` и `hobbies`. Идентификатор (`id`) в формате uuidv4 будет присвоен сервером автоматически. Объект может содержать и прочие свойства, однако они будут проигнорированы.

- В случае успешного выполнения запроса сервер сохранит нового пользователя в массив пользователей и ответит с статус кодом 201 и вновь созданной записью.
- В случае если тело запроса не содержит обязательных полей (см. выше), сервер ответит с статус кодом 400 и соответствующим сообщением.

**PUT запросы на `api/users/id`:**

PUT заросы позволяют частично или полностью изменить информацию о пользователе с введенным `id`.
Объект в теле запроса может содержать как все свойства пользователя (`username`, `age`, `hobbies`) так и только отдельные из них (для частичного обновления). В случае если объект содержит прочие свойства, они будут проигнорированы.

- В случае успешного выполнения запроса сервер обновит информацию о пользователе с введенным `id` и ответит с статус кодом 200 и обновленной записью пользователя.
- В случае если пользователь с введенным `id` не существует сервер ответит с статус кодом 404 и соответствующим сообщением.
- В случае если `id` введен не корректно (прим `api/users/JustTextNotId`) сервер ответит с статус кодом 400 и соответствующим сообщением.

**DELETE запросы `api/users/id`:**

DELETE запросы позволяют удалить информацию о пользователе с введенным `id`.

- В случае успешного выполнения запроса сервер удалит информацию о пользователе с введенным `id` и ответит с статус кодом 204.
- В случае если пользователь с введенным `id` не существует сервер ответит с статус кодом 404 и соответствующим сообщением.
- В случае если `id` введен не корректно (прим `api/users/JustTextNotId`) сервер ответит с статус кодом 400 и соответствующим сообщением.

**Обработка ошибок**

- В случае запроса на несуществующую конечную сервер ответит с статусом 404 и соответствующим сообщением.
- В случае возникновения ошибки на стороне сервера он ответит с статусом 500 и соответствующим сообщением.
- В случае использования не поддерживаемого метода сервер ответит с статус кодом 501 и соответствующим сообщением.

## Дополнительная информация:

Основной и резервный порт для приложения хранится в файле `.env`. При запуске сервер выберет либо основной (5000), либо резервный (4000), либо запустит его на порте 3000.

## Контакты:

В случае необходимости получения дополнительной информации, и/или каких либо разъяснений по логике работы приложения можете связаться со мной:

- Discord: `ch1rik#2995`
- Email: `vladislav@cheremis.in`

**Приятного пользования!**
